(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67997,       1361]
NotebookOptionsPosition[     67078,       1341]
NotebookOutlinePosition[     67470,       1357]
CellTagsIndexPosition[     67427,       1354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"Immunity", "-", 
   RowBox[{
   "driven", " ", "evolution", " ", "of", " ", "virulence", " ", "and", " ", 
    "diversity", " ", "in", " ", "respiratory", " ", "diseases"}]}], 
  "Section"]], "Input",
 CellChangeTimes->{{3.798888288747875*^9, 3.798888298058567*^9}, {
   3.7988890928521833`*^9, 3.7988890931705503`*^9}, {3.7989538807707*^9, 
   3.798953886280369*^9}, 
   3.852866477607452*^9},ExpressionUUID->"9acefaa5-d0a4-415c-a3e8-\
fe0bd3ec071e"],

Cell["J.A.J.Metz & B.Boldin", "Author",
 CellChangeTimes->{{3.8528664799957123`*^9, 
  3.852866508357205*^9}},ExpressionUUID->"102466a1-488f-41be-9c05-\
487ee62916d4"],

Cell[TextData[{
 "This notebook contains the code to replicate evolutionary trees in:\n",
 StyleBox["J.A.J. Metz, B. Boldin:  Immunity-driven evolution of virulence \
and diversity in respiratory diseases (to appear in Evolution)",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.8528665164461527`*^9, 3.852866530381712*^9}, {
  3.899889393940683*^9, 
  3.899889400733136*^9}},ExpressionUUID->"7fb4750b-40eb-47bc-8bf7-\
ecaed912b519"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"parameters", ",", " ", 
    RowBox[{"trade", "-", 
     RowBox[{"off", " ", "functions"}]}], ",", " ", 
    RowBox[{"cross", "-", 
     RowBox[{"immunity", " ", "function"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"par", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N0", "\[Rule]", 
        RowBox[{"10", "^", "5"}]}], ",", " ", 
       RowBox[{"alpha0", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"alpha1", "\[Rule]", "1"}], ",", 
       RowBox[{"gamma0", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"beta0", "\[Rule]", "0.5"}], ",", " ", 
       RowBox[{"k", "\[Rule]", "2"}], ",", 
       RowBox[{"l", "\[Rule]", "2"}], ",", " ", 
       RowBox[{"m1", "\[Rule]", "2"}], ",", " ", 
       RowBox[{"m2", "\[Rule]", "12"}], ",", " ", 
       RowBox[{"c", "\[Rule]", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"m1", " ", "=", " ", 
      RowBox[{
       RowBox[{"m", " ", "and", " ", "m2"}], " ", "=", " ", 
       RowBox[{"n", " ", "in", " ", "the", " ", "paper"}]}]}], ";", " ", 
     RowBox[{"delta", " ", "=", " ", "1"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"alpha", "[", "u_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"alpha0", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"alpha1", "*", 
          RowBox[{"u", "^", "k"}]}]}], ")"}]}], "/.", "par"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"beta", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"beta0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u", "^", "m1"}], "-", 
          RowBox[{"u", "^", "m2"}]}], ")"}]}], ")"}], "/.", "par"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gamma", "[", "u_", "]"}], "  ", ":=", 
     RowBox[{
      RowBox[{"gamma0", "*", 
       RowBox[{"u", "^", "l"}]}], "/.", "par"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", 
      RowBox[{"u_", ",", "v_"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "c"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"u", "-", "v"}], ")"}], "^", "2"}], "/", "2"}]}], "]"}], 
       ")"}], "/.", "par"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta", "[", 
      RowBox[{"k_", ",", "P_"}], "]"}], ":=", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"phi", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"P", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta1", "[", 
      RowBox[{"y_", ",", "P_"}], "]"}], ":=", " ", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"phi", "[", 
         RowBox[{"y", ",", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"P", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta", "[", "P_", "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Theta", "[", 
        RowBox[{"k", ",", " ", "P"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.798953950805825*^9, 3.798953985875422*^9}, {
   3.798958851059073*^9, 3.798958852280094*^9}, {3.798962238158584*^9, 
   3.798962267797431*^9}, {3.798962309300274*^9, 3.7989623094510527`*^9}, 
   3.798962572898679*^9, {3.7989632478408403`*^9, 3.798963252382226*^9}, {
   3.7989633037854424`*^9, 3.798963303865015*^9}, 3.798963337525419*^9, {
   3.79896581383454*^9, 3.79896581393711*^9}, {3.798966182490487*^9, 
   3.798966186712776*^9}, {3.798966538015931*^9, 3.798966538492985*^9}, {
   3.798966866883605*^9, 3.7989668729859543`*^9}, {3.798967394917691*^9, 
   3.798967420245084*^9}, {3.798967742102202*^9, 3.798967742236156*^9}, {
   3.798970286216807*^9, 3.798970290063781*^9}, {3.798971894387424*^9, 
   3.7989719021275377`*^9}, {3.798971979734013*^9, 3.7989719807402697`*^9}, {
   3.7989720806929197`*^9, 3.7989720814738007`*^9}, {3.798972154670858*^9, 
   3.79897215577302*^9}, {3.798972502214213*^9, 3.798972502779273*^9}, 
   3.798972711263974*^9, {3.7989733388081017`*^9, 3.798973344677977*^9}, {
   3.798973377401155*^9, 3.798973378188943*^9}, {3.798973430448832*^9, 
   3.7989734406713057`*^9}, {3.798973858065076*^9, 3.7989738605344057`*^9}, {
   3.798973905175102*^9, 3.798973908053707*^9}, {3.798974055393797*^9, 
   3.798974055535931*^9}, 3.798974117133719*^9, {3.798974271589169*^9, 
   3.798974276891451*^9}, 3.798974335879397*^9, {3.798974638120256*^9, 
   3.798974638238345*^9}, {3.798974829204516*^9, 3.798974829865641*^9}, {
   3.798975039228137*^9, 3.798975039362461*^9}, {3.798975446745224*^9, 
   3.798975446998047*^9}, 3.79897555666222*^9, {3.7989762078993387`*^9, 
   3.798976213256082*^9}, 3.798976503834978*^9, {3.79897669865837*^9, 
   3.798976699656467*^9}, {3.7989767944331617`*^9, 3.798976817741713*^9}, 
   3.7989768772851677`*^9, {3.7989770768623123`*^9, 3.79897708208985*^9}, {
   3.7989775569873953`*^9, 3.798977557050077*^9}, {3.799029599942024*^9, 
   3.799029600276208*^9}, {3.799053308645446*^9, 3.7990533127182493`*^9}, {
   3.799156543748952*^9, 3.799156556561344*^9}, {3.799156798068749*^9, 
   3.799156799138364*^9}, {3.7991585074155073`*^9, 3.7991585094706993`*^9}, 
   3.799158629923026*^9, {3.799158712621714*^9, 3.7991587134913197`*^9}, 
   3.7991588846315393`*^9, 3.799159238362885*^9, {3.799159712594006*^9, 
   3.799159714734192*^9}, 3.799160650308886*^9, {3.7991607083455143`*^9, 
   3.799160717231821*^9}, {3.79916075945226*^9, 3.799160759577853*^9}, {
   3.799160958153841*^9, 3.7991609590869904`*^9}, 3.799164583503887*^9, {
   3.799164623650928*^9, 3.799164656408822*^9}, {3.799164699719174*^9, 
   3.799164707581636*^9}, {3.79916474994209*^9, 3.7991647678889303`*^9}, {
   3.799164799257876*^9, 3.799164829948762*^9}, {3.7991650313714447`*^9, 
   3.799165031560471*^9}, {3.7991659468274603`*^9, 3.799165946920623*^9}, 
   3.799166826150896*^9, 3.799167423709538*^9, {3.799167661170842*^9, 
   3.799167663536854*^9}, 3.7991678332208776`*^9, 3.799168032833621*^9, {
   3.7991681774310083`*^9, 3.799168180588382*^9}, 3.799168286450108*^9, {
   3.7991684206732388`*^9, 3.799168421542346*^9}, {3.7991685277219152`*^9, 
   3.799168536226305*^9}, {3.7991686104073772`*^9, 3.799168628776897*^9}, {
   3.799168704321145*^9, 3.799168708078773*^9}, 3.7991688492824097`*^9, {
   3.799169009473379*^9, 3.7991690095986834`*^9}, 3.799169364083343*^9, {
   3.799169796466185*^9, 3.799169797903121*^9}, 3.799169894846633*^9, {
   3.7991700326866493`*^9, 3.7991700803927097`*^9}, {3.799170163149276*^9, 
   3.799170167970945*^9}, {3.799170446924271*^9, 3.799170447937619*^9}, 
   3.799170789959058*^9, {3.799171049733759*^9, 3.799171063525198*^9}, {
   3.7991711018443203`*^9, 3.79917112397184*^9}, 3.799171177974553*^9, {
   3.7991713111103487`*^9, 3.7991713183273363`*^9}, 3.799171437456307*^9, {
   3.799171809021657*^9, 3.79917181302075*^9}, {3.799171993342267*^9, 
   3.799172001250808*^9}, 3.799172098596537*^9, {3.7991722148200083`*^9, 
   3.79917221601001*^9}, {3.7991725659533167`*^9, 3.799172574816482*^9}, 
   3.799172778095804*^9, {3.799172848318365*^9, 3.799172858190099*^9}, 
   3.7991732170593233`*^9, {3.799173284063612*^9, 3.799173318134931*^9}, {
   3.7991733928000917`*^9, 3.799173393358482*^9}, {3.7991963777764187`*^9, 
   3.79919637986917*^9}, {3.79919660828612*^9, 3.799196610012319*^9}, {
   3.799196690422579*^9, 3.799196704428403*^9}, {3.7991973274587*^9, 
   3.799197351480919*^9}, 3.7991975521154118`*^9, {3.79919797898071*^9, 
   3.799197983520643*^9}, {3.799198231730666*^9, 3.799198246138543*^9}, 
   3.79919845230762*^9, {3.79919880618906*^9, 3.799198880856139*^9}, {
   3.799198932735312*^9, 3.7991989396335783`*^9}, {3.799198985269895*^9, 
   3.7991990169011507`*^9}, {3.799199271792808*^9, 3.799199272357902*^9}, {
   3.799199597960031*^9, 3.7991995990932217`*^9}, {3.799200793752532*^9, 
   3.799200797163416*^9}, 3.799201108873864*^9, {3.799201205686854*^9, 
   3.799201205900824*^9}, {3.799202404192124*^9, 3.79920241515565*^9}, {
   3.799202754346196*^9, 3.799202754783317*^9}, {3.799202918834668*^9, 
   3.799202919520887*^9}, {3.799204020378152*^9, 3.7992040231117067`*^9}, {
   3.799204065014978*^9, 3.799204066029048*^9}, {3.7992041328475513`*^9, 
   3.7992041339807577`*^9}, {3.7992043502220583`*^9, 3.799204351403216*^9}, 
   3.7992046900128393`*^9, 3.79920472822643*^9, {3.799204954056707*^9, 
   3.7992049544228287`*^9}, {3.7992049988095922`*^9, 3.799205033116576*^9}, {
   3.799205121146166*^9, 3.79920512211215*^9}, {3.7992051721651707`*^9, 
   3.799205172739222*^9}, {3.799205286437766*^9, 3.79920528797929*^9}, {
   3.799205577474551*^9, 3.799205580016492*^9}, {3.799205684040928*^9, 
   3.7992056844229507`*^9}, {3.7992057280914297`*^9, 3.799205728753728*^9}, {
   3.7992060788454437`*^9, 3.79920607952297*^9}, {3.799206115863503*^9, 
   3.799206120082307*^9}, {3.799206357760543*^9, 3.799206358470806*^9}, {
   3.7992064626928043`*^9, 3.799206463714918*^9}, {3.799219489513747*^9, 
   3.7992195038088293`*^9}, {3.7992195789125147`*^9, 
   3.7992195796167088`*^9}, {3.799219627338599*^9, 3.799219638049693*^9}, 
   3.799219683917865*^9, {3.79921980198997*^9, 3.799219802651935*^9}, {
   3.7992200241221323`*^9, 3.799220025679247*^9}, {3.79922013441818*^9, 
   3.7992201349840612`*^9}, {3.799220185550572*^9, 3.799220185972558*^9}, {
   3.79922041263722*^9, 3.79922041329047*^9}, 3.7992204800789337`*^9, {
   3.799221217020225*^9, 3.7992212196026154`*^9}, {3.799221326154175*^9, 
   3.799221367715518*^9}, {3.799221601982277*^9, 3.799221602539242*^9}, {
   3.79922176700504*^9, 3.7992217673938704`*^9}, {3.799221809535348*^9, 
   3.799221810189665*^9}, {3.7992236648552*^9, 3.79922368579272*^9}, {
   3.7992249364264717`*^9, 3.799224937207152*^9}, 3.799225163199093*^9, {
   3.7992258348260098`*^9, 3.7992258386097393`*^9}, {3.7992259295856743`*^9, 
   3.799225929736322*^9}, {3.7992261596499357`*^9, 3.7992261600472097`*^9}, {
   3.799226309948739*^9, 3.799226310329832*^9}, {3.799226422867867*^9, 
   3.799226424129951*^9}, {3.799236581204303*^9, 3.7992365827376757`*^9}, {
   3.799236674470192*^9, 3.799236692028771*^9}, {3.799237427629868*^9, 
   3.799237432411913*^9}, {3.799416238535852*^9, 3.7994162401960373`*^9}, {
   3.799458510432602*^9, 3.7994585107256947`*^9}, {3.7994585705371532`*^9, 
   3.799458570999154*^9}, 3.7994589097482443`*^9, 3.799459020724639*^9, {
   3.799459474251478*^9, 3.7994594746655197`*^9}, {3.799459782274665*^9, 
   3.799459786055457*^9}, {3.7994598339498253`*^9, 3.799459836619665*^9}, {
   3.799459998630088*^9, 3.799460002947281*^9}, {3.79946004304111*^9, 
   3.799460047359054*^9}, {3.7994601482795143`*^9, 3.799460149213729*^9}, {
   3.799460215660863*^9, 3.799460216363064*^9}, {3.799479311181657*^9, 
   3.7994793118116302`*^9}, 3.799479901562048*^9, {3.799479991957612*^9, 
   3.799479993275415*^9}, {3.799480231223105*^9, 3.7994802318374557`*^9}, {
   3.799483937414085*^9, 3.799483953598035*^9}, {3.799484105394627*^9, 
   3.7994841068244543`*^9}, {3.799484143131462*^9, 3.79948415089828*^9}, {
   3.799484255977868*^9, 3.799484273853241*^9}, {3.799484506347104*^9, 
   3.799484517984273*^9}, 3.799484840638262*^9, {3.799485035512998*^9, 
   3.799485046861535*^9}, 3.799486546394178*^9, {3.7994866352657423`*^9, 
   3.7994866377763643`*^9}, {3.7994867572593937`*^9, 
   3.7994867626971684`*^9}, {3.799486913374024*^9, 3.799486952123477*^9}, {
   3.799487016385449*^9, 3.7994870187606573`*^9}, {3.7994891303356543`*^9, 
   3.799489155605693*^9}, {3.7994892298633327`*^9, 3.799489230269865*^9}, {
   3.799489401987213*^9, 3.79948942186495*^9}, {3.799489489463282*^9, 
   3.7994895193513517`*^9}, {3.7994895943288517`*^9, 3.799489620172441*^9}, {
   3.799496725495338*^9, 3.799496799515963*^9}, {3.79949690398591*^9, 
   3.799496999505765*^9}, 3.7994970683913603`*^9, {3.7994972133298798`*^9, 
   3.799497213695991*^9}, {3.799497752937388*^9, 3.79949775375066*^9}, {
   3.799547262092752*^9, 3.799547316808632*^9}, {3.79954747611273*^9, 
   3.799547476303141*^9}, 3.799547560669581*^9, {3.799547665095726*^9, 
   3.7995476677658253`*^9}, {3.7995477281413193`*^9, 3.799547736531496*^9}, {
   3.7995478987661057`*^9, 3.799547900644024*^9}, {3.799548654663945*^9, 
   3.7995486599417963`*^9}, {3.804497660270176*^9, 3.804497664060268*^9}, {
   3.8044977415836554`*^9, 3.8044977461512613`*^9}, {3.8044978068268642`*^9, 
   3.8044978099930964`*^9}, {3.804497909088976*^9, 3.804497910263144*^9}, {
   3.804498429993843*^9, 3.804498430671824*^9}, {3.804937939463791*^9, 
   3.8049379545904417`*^9}, 3.804939768631343*^9, {3.804940187202153*^9, 
   3.804940187711841*^9}, {3.804940476749837*^9, 3.804940485035755*^9}, 
   3.804941142957008*^9, {3.804941808927009*^9, 3.80494181363099*^9}, 
   3.804942069279353*^9, {3.804942408396888*^9, 3.8049424145334053`*^9}, {
   3.804946578010165*^9, 3.804946651996573*^9}, 3.804946721842557*^9, 
   3.804946785698598*^9, {3.804946824135371*^9, 3.804946861054409*^9}, {
   3.804946969584198*^9, 3.804946999284419*^9}, {3.804947487944696*^9, 
   3.804947488175115*^9}, {3.804948189715897*^9, 3.8049481907150373`*^9}, {
   3.80498641214496*^9, 3.8049864125267572`*^9}, {3.805003021932609*^9, 
   3.805003033002521*^9}, 3.805003206753405*^9, {3.805003237563349*^9, 
   3.805003238273408*^9}, 3.805010118435842*^9, {3.805010155736497*^9, 
   3.805010156245283*^9}, 3.805010208086836*^9, {3.8050104861946983`*^9, 
   3.805010486296648*^9}, {3.805010628645082*^9, 3.805010629098194*^9}, 
   3.805011113907495*^9, {3.805012032305863*^9, 3.805012037951213*^9}, {
   3.805014100242094*^9, 3.805014102935182*^9}, {3.805015613918779*^9, 
   3.805015620034967*^9}, 3.8050156692522984`*^9, {3.80501589019147*^9, 
   3.805015893372868*^9}, {3.805016703131144*^9, 3.805016704173258*^9}, {
   3.80502262080075*^9, 3.8050226216213408`*^9}, {3.805026646320716*^9, 
   3.805026646443791*^9}, {3.805027753627891*^9, 3.8050277569776907`*^9}, 
   3.805027856429788*^9, {3.8050280933996*^9, 3.805028110533807*^9}, 
   3.8050281414650393`*^9, 3.805028860766576*^9, {3.8050289526943483`*^9, 
   3.8050289546123734`*^9}, {3.80502905833597*^9, 3.805029070476303*^9}, {
   3.805029142450141*^9, 3.805029143176162*^9}, {3.805031132783584*^9, 
   3.8050311452436047`*^9}, 3.8050313277902822`*^9, {3.805031511677412*^9, 
   3.805031513516139*^9}, {3.805031626274238*^9, 3.805031626615572*^9}, {
   3.805031876093109*^9, 3.8050318810598917`*^9}, 3.805031949619412*^9, {
   3.805031997414756*^9, 3.80503202245227*^9}, {3.8050341082356*^9, 
   3.8050341119918222`*^9}, {3.805075090291092*^9, 3.805075107552752*^9}, {
   3.8050797604894857`*^9, 3.805079761196065*^9}, {3.80508155167268*^9, 
   3.805081554989933*^9}, {3.805090359730576*^9, 3.805090368779772*^9}, {
   3.805093641009013*^9, 3.80509364522301*^9}, {3.805094985894227*^9, 
   3.805094986052259*^9}, {3.805095037160325*^9, 3.8050950380214777`*^9}, {
   3.805106397409647*^9, 3.805106423546019*^9}, {3.805107437329768*^9, 
   3.8051074498187017`*^9}, {3.8051081920023108`*^9, 3.805108192096599*^9}, {
   3.805108542994206*^9, 3.805108543375381*^9}, 3.8051106219157543`*^9, {
   3.8144235143206053`*^9, 3.814423536537758*^9}, {3.8144236840112677`*^9, 
   3.8144237165894737`*^9}, {3.8144239465110207`*^9, 3.814423952734234*^9}, {
   3.8144270073644953`*^9, 3.814427096781784*^9}, {3.814427326416177*^9, 
   3.81442733350276*^9}, {3.814427593681131*^9, 3.8144276347830563`*^9}, {
   3.814427683905902*^9, 3.814427687016591*^9}, {3.814428369368906*^9, 
   3.814428395001174*^9}, {3.814428577617622*^9, 3.8144285777366247`*^9}, {
   3.814428908044651*^9, 3.814428908235026*^9}, {3.814429388623013*^9, 
   3.814429388877645*^9}, {3.814431123214162*^9, 3.814431145637267*^9}, {
   3.814433406447632*^9, 3.814433437668372*^9}, {3.814433908660746*^9, 
   3.8144339091077747`*^9}, {3.81592979512899*^9, 3.8159298511442957`*^9}, {
   3.815929969775346*^9, 3.815929984211431*^9}, {3.815930094044239*^9, 
   3.8159300942831097`*^9}, {3.8159302948115377`*^9, 3.815930303857209*^9}, {
   3.815930385264288*^9, 3.815930400671274*^9}, 3.81598935690455*^9, {
   3.815989429570808*^9, 3.815989430313424*^9}, {3.815991298687149*^9, 
   3.815991298740141*^9}, {3.8159921564936047`*^9, 3.815992159659697*^9}, {
   3.815992213876712*^9, 3.8159922142112703`*^9}, {3.815992456931044*^9, 
   3.8159924574900217`*^9}, {3.81599308305857*^9, 3.81599308611897*^9}, {
   3.815993532959145*^9, 3.815993533758404*^9}, {3.81599417676537*^9, 
   3.8159941961692142`*^9}, {3.816573197976529*^9, 3.816573198438559*^9}, 
   3.816574238001088*^9, {3.816593331000358*^9, 3.816593335206807*^9}, {
   3.816595634746189*^9, 3.816595635504203*^9}, {3.8167017444467*^9, 
   3.816701761327119*^9}, {3.816753417101715*^9, 3.816753438662629*^9}, {
   3.8170158825767593`*^9, 3.817015882875937*^9}, {3.817646356938513*^9, 
   3.8176463649514427`*^9}, {3.817646995353712*^9, 3.817647013124308*^9}, {
   3.817658857220837*^9, 3.8176588876438*^9}, {3.817658978735901*^9, 
   3.8176589857340813`*^9}, {3.8216774578225203`*^9, 3.821677494404999*^9}, {
   3.821678491558325*^9, 3.821678498916432*^9}, {3.8216799403355103`*^9, 
   3.821679945815398*^9}, {3.821680069473137*^9, 3.8216800702581987`*^9}, {
   3.82168032254317*^9, 3.8216803234701967`*^9}, {3.821680956962102*^9, 
   3.821680960873711*^9}, {3.821681433377912*^9, 3.8216814339202023`*^9}, 
   3.821681487782909*^9, {3.821683126236218*^9, 3.821683129229104*^9}, {
   3.821685353505951*^9, 3.821685353655972*^9}, 3.821685511885789*^9, {
   3.8216860232211533`*^9, 3.821686026234466*^9}, {3.821686638522168*^9, 
   3.821686643064089*^9}, {3.8216891856539593`*^9, 3.821689194916621*^9}, {
   3.821695237332749*^9, 3.821695238344948*^9}, 3.821695295274117*^9, {
   3.821695509849568*^9, 3.821695509973414*^9}, {3.8524563886074247`*^9, 
   3.852456388660696*^9}, {3.8524571699286957`*^9, 3.852457170253085*^9}, {
   3.852866547714266*^9, 3.852866647964818*^9}, {3.852866681935375*^9, 
   3.852866735597879*^9}, 3.852866777648409*^9, {3.852866835565525*^9, 
   3.8528668439471188`*^9}, {3.852867885459577*^9, 3.852867885536119*^9}, {
   3.8528684025091543`*^9, 3.852868402568713*^9}, {3.8528724919155293`*^9, 
   3.852872491961483*^9}, {3.8552296085226603`*^9, 3.855229608626124*^9}, {
   3.89988960529661*^9, 3.89988960533125*^9}, {3.899891747602213*^9, 
   3.899891748247567*^9}, {3.899891782316762*^9, 
   3.899891810466935*^9}},ExpressionUUID->"398c53f7-1ffb-47de-a950-\
ea31d118a1a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"evolutionary", " ", 
    RowBox[{"tree", ":", " ", 
     RowBox[{
     "initial", " ", "conditions", " ", "and", " ", "parameters"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", " ", "=", " ", 
     RowBox[{"{", "0.3", "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"initial", " ", "strain"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", " ", 
     RowBox[{"Length", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strains", " ", "=", " ", 
     RowBox[{"Range", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"liststrains", " ", "=", " ", 
     RowBox[{"Subsets", "[", "strains", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xtree", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"initial", " ", "conditions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iniS", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"S", ",", " ", "P"}], "]"}], "[", "0", "]"}], "\[Equal]",
            "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"P", ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"liststrains", ",", 
              RowBox[{"{", "}"}]}], "]"}]}], " ", "}"}]}], "]"}], "]"}], ",", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"S", ",", 
            RowBox[{"{", "}"}]}], "]"}], "[", "0", "]"}], "\[Equal]", "N0"}], 
        "/.", "par"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iniI", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"II", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "0", "]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"P", ",", 
          RowBox[{"Subsets", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ini", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"iniS", ",", " ", "iniI"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tend", " ", "=", "1000"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "time", " ", "for", " ", "population", " ", 
     "dynamics"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kend", " ", "=", " ", "5000"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "number", " ", "of", " ", "mutations", " ", "to", " ", "compute", " ", 
       "evolutionary", " ", "tree"}], ";", " ", 
      RowBox[{
       RowBox[{"in", " ", "the", " ", "paper", " ", "Kend"}], " ", "=", " ", 
       "50000"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"eps", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"extinction", " ", "threshold"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sigma", " ", "=", " ", "0.007"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "standard", " ", "deviation", " ", "of", " ", "mutation", " ", 
      "distribution"}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.798890730529449*^9, 3.7988907308247547`*^9}, {
   3.798890803967605*^9, 3.798890806957837*^9}, {3.7988908470375557`*^9, 
   3.798890868114024*^9}, 3.798891274872258*^9, {3.798903421666058*^9, 
   3.798903422110013*^9}, {3.798903592060237*^9, 3.798903620132998*^9}, {
   3.798903683187023*^9, 3.7989037421001577`*^9}, {3.7989038387092743`*^9, 
   3.798903843409184*^9}, {3.798905011692792*^9, 3.798905017367854*^9}, {
   3.798905262159109*^9, 3.798905267955845*^9}, {3.798905383703912*^9, 
   3.798905388513962*^9}, {3.7989054399976597`*^9, 3.7989054426265297`*^9}, {
   3.798905480304631*^9, 3.798905481029755*^9}, {3.798905978691411*^9, 
   3.798905979672991*^9}, {3.7989061481258783`*^9, 3.798906148969758*^9}, {
   3.7989063275016212`*^9, 3.798906340628687*^9}, {3.798906432474663*^9, 
   3.798906461890327*^9}, {3.798906528512412*^9, 3.798906539094007*^9}, {
   3.798906664063839*^9, 3.798906675335409*^9}, {3.798906766272914*^9, 
   3.798906769676648*^9}, {3.7989071440220327`*^9, 3.798907169117508*^9}, {
   3.798907259411797*^9, 3.798907295431945*^9}, {3.798907360504068*^9, 
   3.7989073855819387`*^9}, {3.7989074247580967`*^9, 
   3.7989074273722887`*^9}, {3.7989074725658503`*^9, 3.798907472909651*^9}, {
   3.7989078051683903`*^9, 3.798907820622765*^9}, {3.798908105827581*^9, 
   3.798908106680389*^9}, {3.798908907081874*^9, 3.798908908920244*^9}, {
   3.7989089860405207`*^9, 3.79890906554248*^9}, {3.798909178045322*^9, 
   3.7989091834511757`*^9}, {3.798909221288048*^9, 3.79890922446906*^9}, {
   3.798910076575345*^9, 3.798910086332662*^9}, {3.7989101469607897`*^9, 
   3.798910147189546*^9}, {3.798910309144877*^9, 3.798910310143454*^9}, {
   3.798910382199423*^9, 3.798910382778449*^9}, 3.798910438883356*^9, {
   3.7989106449154053`*^9, 3.7989106456155643`*^9}, {3.798953908262941*^9, 
   3.798953931193858*^9}, {3.798958504073474*^9, 3.798958504829977*^9}, {
   3.798962014045003*^9, 3.7989620158190813`*^9}, {3.798962314372902*^9, 
   3.798962316330778*^9}, {3.798962567947598*^9, 3.798962569704327*^9}, {
   3.7989719889612913`*^9, 3.798971996684762*^9}, {3.799156561988242*^9, 
   3.799156562120957*^9}, {3.799484527105649*^9, 3.7994845279756527`*^9}, {
   3.799485059241913*^9, 3.799485059390974*^9}, {3.799497199740944*^9, 
   3.7994972004071417`*^9}, {3.799547364789455*^9, 3.799547364923461*^9}, {
   3.804937966262578*^9, 3.804937969637032*^9}, {3.8049384874464703`*^9, 
   3.8049384886526203`*^9}, {3.804938727651582*^9, 3.804938728616993*^9}, {
   3.804938953093281*^9, 3.8049389538103724`*^9}, {3.804939632377315*^9, 
   3.804939633215144*^9}, {3.804940505805771*^9, 3.804940508987773*^9}, {
   3.804941819934917*^9, 3.804941820730344*^9}, {3.80494198571207*^9, 
   3.804941986379663*^9}, {3.804942032408956*^9, 3.80494203255895*^9}, {
   3.804942112135284*^9, 3.804942112660304*^9}, {3.804942243666768*^9, 
   3.804942244144971*^9}, {3.804942355221116*^9, 3.8049423566736107`*^9}, {
   3.804942421236497*^9, 3.804942421418531*^9}, {3.80494553277457*^9, 
   3.804945533887546*^9}, {3.804946432015847*^9, 3.8049464340203743`*^9}, {
   3.804946691354217*^9, 3.804946692256175*^9}, {3.804946934117332*^9, 
   3.804946957522368*^9}, {3.804947108947341*^9, 3.804947109807682*^9}, {
   3.804947992781657*^9, 3.8049479928584633`*^9}, {3.8050030450755577`*^9, 
   3.8050030475541973`*^9}, {3.8050039971530647`*^9, 3.805004007686606*^9}, {
   3.8050093182192593`*^9, 3.805009318595714*^9}, {3.805010124345098*^9, 
   3.805010125527151*^9}, {3.8050102119585648`*^9, 3.80501021251665*^9}, {
   3.805010252719207*^9, 3.805010252869425*^9}, {3.805010310567192*^9, 
   3.805010312437503*^9}, {3.805014112352647*^9, 3.805014112503024*^9}, {
   3.805015626300206*^9, 3.805015627210308*^9}, {3.8050156761935062`*^9, 
   3.805015676415463*^9}, {3.805015899358405*^9, 3.8050158996922417`*^9}, {
   3.805018107977063*^9, 3.805018108796279*^9}, {3.8050228213592577`*^9, 
   3.8050228222755632`*^9}, {3.805031637209844*^9, 3.805031637975251*^9}, {
   3.805034120401269*^9, 3.805034120544022*^9}, {3.805075197993709*^9, 
   3.805075198144044*^9}, {3.80508156108016*^9, 3.805081561652855*^9}, {
   3.80509049578019*^9, 3.805090495889114*^9}, {3.805093651936027*^9, 
   3.8050936529184237`*^9}, {3.8144236211077013`*^9, 3.814423621218811*^9}, {
   3.8159893640604267`*^9, 3.815989364235374*^9}, {3.8159927784823513`*^9, 
   3.815992778585786*^9}, {3.817647019285267*^9, 3.817647022523658*^9}, {
   3.8176588211610193`*^9, 3.8176588234114103`*^9}, {3.817658993535017*^9, 
   3.817658997772876*^9}, {3.82167750140569*^9, 3.8216775040124693`*^9}, {
   3.8216775873213253`*^9, 3.821677599632495*^9}, {3.821679950207122*^9, 
   3.8216799556920357`*^9}, {3.821680974355133*^9, 3.821680981441435*^9}, {
   3.821683147957061*^9, 3.8216831511056767`*^9}, {3.82168348216588*^9, 
   3.821683485163933*^9}, {3.821683602270659*^9, 3.8216836024047403`*^9}, {
   3.821684800858883*^9, 3.821684803137315*^9}, {3.8216855164142103`*^9, 
   3.821685517395993*^9}, {3.821686030852027*^9, 3.821686031842217*^9}, {
   3.852866849123725*^9, 3.852866864823861*^9}, {3.8528670268363457`*^9, 
   3.8528671184717093`*^9}, 3.852867612375682*^9, 3.8528676466735067`*^9, {
   3.852867888776306*^9, 3.852867900928603*^9}, 3.852867939748434*^9, {
   3.852868166845323*^9, 3.852868331312911*^9}, {3.852868376496078*^9, 
   3.852868412626083*^9}, {3.852868498555526*^9, 3.852868498617394*^9}, {
   3.85287069357895*^9, 3.852870694911606*^9}, {3.8528709030478067`*^9, 
   3.852870907541251*^9}, {3.85287152231354*^9, 3.852871531018162*^9}, {
   3.852872268441924*^9, 3.8528722859287243`*^9}, {3.852872335765544*^9, 
   3.852872386783381*^9}, {3.852872500564212*^9, 3.852872521692305*^9}, 
   3.855229320274496*^9, 3.855229361414163*^9, {3.8552296149314528`*^9, 
   3.855229615951674*^9}, {3.899891824386383*^9, 3.899891857261989*^9}, {
   3.899891931788113*^9, 3.89989193344549*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"5aa158f5-0505-44a2-a337-f3d4d2ef917a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"evolutionary", " ", 
    RowBox[{"tree", ":", " ", "computation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"strains", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"liststrains", " ", "=", " ", 
      RowBox[{"Subsets", "[", "strains", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"trade", "-", 
       RowBox[{
       "off", " ", "vectors", " ", "for", " ", "present", " ", "strains"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"gammal", " ", "=", " ", 
      RowBox[{"gamma", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alphal", " ", "=", " ", 
      RowBox[{"alpha", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"betal", "=", " ", 
      RowBox[{"beta", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"system", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eqnS", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"S", ",", 
                RowBox[{"{", "}"}]}], "]"}], "'"}], "[", "t", "]"}], 
            "\[Equal]", " ", 
            RowBox[{"(", 
             RowBox[{"N0", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{"betal", "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"P", ",", "i"}], "]"}], "\[Equal]", "False"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"II", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "t", "]"}], 
                    ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"P", ",", "liststrains"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
                 ")"}], "*", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"S", ",", 
                  RowBox[{"{", "}"}]}], "]"}], "[", "t", "]"}]}]}], ")"}]}], "/.",
            "par"}], "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"S", ",", "P"}], "]"}], "'"}], "[", "t", "]"}], " ", 
            "\[Equal]", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"gammal", ".", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"P", ",", "i"}], "]"}], "\[Equal]", "True"}], ",",
                   " ", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"II", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"P", ",", "i"}], "]"}]}], "}"}]}], "]"}], "[", 
                   "t", "]"}], ",", "0"}], "]"}], " ", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], " ", "-", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"S", ",", "P"}], "]"}], "[", "t", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"Theta", "[", "P", "]"}], "*", "betal", "*", 
                  RowBox[{"Total", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"P", ",", "i"}], "]"}], "\[Equal]", "False"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"II", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "t", "]"}], 
                    ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"P", ",", "liststrains"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}]}],
                ")"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"P", ",", " ", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"liststrains", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqnI", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"II", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"P", ",", "i"}], "]"}]}], "}"}]}], "]"}], "'"}], "[",
            "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"S", ",", "P"}], "]"}], "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Theta", "[", "P", "]"}], "*", "betal", "*", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"II", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "t", "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"P", ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"strains", ",", " ", "i"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{"alphal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
              RowBox[{"gammal", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"II", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"P", ",", "i"}], "]"}]}], "}"}]}], "]"}], "[", "t", 
             "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"P", ",", " ", 
           RowBox[{"Subsets", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"eqnS", ",", " ", "eqnI"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"varsS", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"P", ",", "liststrains"}], " ", "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"varsI", " ", "=", "  ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"II", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "P"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"P", ",", 
           RowBox[{"Subsets", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"varsS", ",", " ", "varsI"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"system", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"eqns", ",", " ", "ini"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Run", " ", "the", " ", "system", " ", "until", " ", "Tend"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"NDSolve", "[", 
       RowBox[{"system", ",", " ", "vars", ",", " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", " ", "0", ",", " ", "Tend"}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<EquationSimplification\>\"", "\[Rule]", "\"\<Residual\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"solS", ",", "P"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"S", ",", "P"}], "]"}], "/.", 
         RowBox[{"s", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"P", ",", " ", "liststrains"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"solI", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "=", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"II", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "/.", 
         RowBox[{"s", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"P", ",", " ", 
         RowBox[{"Subsets", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalI", "[", 
       RowBox[{"i_", ",", "t_"}], "]"}], ":=", 
      RowBox[{"Total", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"solI", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"P", ",", 
           RowBox[{"Subsets", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TotalIend", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TotalI", "[", 
          RowBox[{"i", ",", "Tend"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "If", " ", "the", " ", "total", " ", "load", " ", "is", " ", "below", 
        " ", "a", " ", "specified", " ", "value", " ", "eps"}], ",", " ", 
       RowBox[{"the", " ", "strain", " ", "is", " ", "declared", " ", 
        RowBox[{"extinct", ".", " ", "Determine"}], " ", "the", " ", 
        "strains", " ", "the", " ", "persist", " ", "and", " ", "set", " ", 
        "the", " ", "initial", " ", "conditions", " ", "for", " ", "the", " ",
         "next", " ", "strain"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"xend", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Iend", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TotalI", "[", 
           RowBox[{"i", ",", "Tend"}], "]"}], "\[GreaterEqual]", " ", "eps"}],
          ",", 
         RowBox[{"xend", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"xend", ",", " ", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TotalI", "[", 
           RowBox[{"i", ",", "Tend"}], "]"}], "\[GreaterEqual]", " ", "eps"}],
          ",", 
         RowBox[{"Iend", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"Iend", ",", " ", 
            RowBox[{"TotalI", "[", 
             RowBox[{"i", ",", "Tend"}], "]"}]}], "]"}]}]}], "]"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "xend", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"xtree", " ", "=", "  ", 
        RowBox[{"Append", "[", 
         RowBox[{"xtree", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xend", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "K"}], "}"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "xend", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lambda", "[", "i_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"betal", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"TotalI", "[", 
        RowBox[{"i", ",", "Tend"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalThetaS", "[", "i_", "]"}], ":=", 
      RowBox[{"Total", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Theta", "[", 
           RowBox[{"i", ",", "P"}], "]"}], "*", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"solS", ",", "P"}], "]"}], "[", "Tend", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"P", ",", "liststrains"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lambdaw", "[", "i_", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"lambda", "[", "i", "]"}], "*", 
       RowBox[{"TotalThetaS", "[", "i", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lambdawT", " ", ":=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"lambdaw", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"weights", " ", "=", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"lambdaw", "[", "i", "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "5"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "/", "lambdawT"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xrand", " ", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"weights", "\[Rule]", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xmut", " ", "=", " ", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"xrand", ",", "sigma"}], "]"}], "]"}], ",", "3"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "choose", " ", "a", " ", "mutant", " ", "and", " ", "determine", " ", 
       "its", " ", "invasion", " ", "probability"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bmut", " ", "=", " ", 
      RowBox[{
       RowBox[{"beta", "[", "xmut", "]"}], "*", 
       RowBox[{"Total", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Theta1", "[", 
            RowBox[{"xmut", ",", " ", "P"}], "]"}], "*", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"solS", ",", " ", "P"}], "]"}], "[", "Tend", "]"}], 
             ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "5"}]}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"P", ",", "liststrains"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dmut", " ", "=", " ", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"alpha", "[", "xmut", "]"}], " ", "+", " ", 
       RowBox[{"gamma", "[", "xmut", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pinv", " ", "=", 
      RowBox[{"1", "-", 
       RowBox[{"dmut", "/", "bmut"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pinv", " ", ">", "0"}], " ", "&&", " ", 
        RowBox[{"p", "<", "pinv"}]}], ",", " ", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"xend", ",", "xmut"}], "]"}]}], ",", 
       RowBox[{"x", " ", "=", " ", "xend"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"update", " ", "the", " ", "list", " ", "of", " ", "strain"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"strains", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"liststrains", " ", "=", " ", 
      RowBox[{"Subsets", "[", "strains", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"iniS", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"S", ",", " ", "P"}], "]"}], "[", "0", "]"}], 
            "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"P", ",", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"liststrains", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], " ", "}"}]}], "]"}], "]"}], ",",
         " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"S", ",", 
             RowBox[{"{", "}"}]}], "]"}], "[", "0", "]"}], "\[Equal]", "N0"}],
          "/.", "par"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iniI", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "P"}], "}"}]}], "]"}], "[", "0", "]"}], 
          "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"P", ",", 
           RowBox[{"Subsets", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"strains", ",", "i"}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ini", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"iniS", ",", " ", "iniI"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "K", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"x", " ", "=", " ", 
      RowBox[{"DeleteDuplicates", "[", "x", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"strains", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"liststrains", " ", "=", " ", 
      RowBox[{"Subsets", "[", "strains", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"K", ",", "1", ",", "Kend"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.79783365589921*^9, 3.797833690227968*^9}, 
   3.797833723829458*^9, {3.797833760650611*^9, 3.7978339956229773`*^9}, {
   3.797834027007627*^9, 3.797834054741366*^9}, {3.797834302843893*^9, 
   3.797834394778385*^9}, {3.797834686663126*^9, 3.797834723455533*^9}, {
   3.797834833441448*^9, 3.797834936130857*^9}, {3.7978349914985247`*^9, 
   3.7978350212310543`*^9}, {3.797835147162025*^9, 3.7978351582248287`*^9}, {
   3.797835194694475*^9, 3.7978352105888567`*^9}, {3.797835275732902*^9, 
   3.797835313747025*^9}, {3.7978353952010307`*^9, 3.797835452552429*^9}, {
   3.797835494362159*^9, 3.79783549679276*^9}, {3.797836397419002*^9, 
   3.7978364024540358`*^9}, {3.797836529191943*^9, 3.797836565414742*^9}, {
   3.797836681323752*^9, 3.797836683448778*^9}, {3.797837239344892*^9, 
   3.797837254948202*^9}, {3.7978376310884123`*^9, 3.7978376325897303`*^9}, {
   3.7978377035770817`*^9, 3.797837703727404*^9}, {3.7978380056006804`*^9, 
   3.797838009734798*^9}, 3.7978382262055893`*^9, {3.7978389968215017`*^9, 
   3.7978390011704073`*^9}, {3.797839750437682*^9, 3.797839777780129*^9}, {
   3.7978398092855883`*^9, 3.797839811961997*^9}, {3.797839952023436*^9, 
   3.797839954897932*^9}, {3.79784021149629*^9, 3.797840242318029*^9}, {
   3.797840340429916*^9, 3.797840343740007*^9}, {3.79784043557769*^9, 
   3.797840514057506*^9}, {3.797840569537919*^9, 3.797840571213633*^9}, {
   3.7978407456461277`*^9, 3.7978407466899633`*^9}, {3.79784082236896*^9, 
   3.79784085138498*^9}, {3.797840906936758*^9, 3.79784098491175*^9}, {
   3.7978411191850157`*^9, 3.7978411307120647`*^9}, {3.797841212702598*^9, 
   3.7978412146415653`*^9}, {3.7978438134327393`*^9, 3.797843828620112*^9}, 
   3.7978439760956917`*^9, {3.797844044819406*^9, 3.797844085394678*^9}, {
   3.7978454006176453`*^9, 3.797845407606094*^9}, {3.797845463845647*^9, 
   3.7978455438455048`*^9}, {3.797845575020508*^9, 3.7978456384211473`*^9}, 
   3.797846102259575*^9, {3.797846244144854*^9, 3.7978462746579943`*^9}, {
   3.797846716788596*^9, 3.7978467576358843`*^9}, 3.7978469119371767`*^9, {
   3.7978470659516563`*^9, 3.79784706881911*^9}, {3.797849004076182*^9, 
   3.79784927068764*^9}, {3.79784935101036*^9, 3.797849482932201*^9}, {
   3.7978495825668097`*^9, 3.7978496046242437`*^9}, {3.797849641086149*^9, 
   3.797849684377515*^9}, 3.797849833432598*^9, 3.797849971344466*^9, {
   3.79785328664062*^9, 3.7978532930782127`*^9}, {3.797853341901132*^9, 
   3.7978533429003057`*^9}, {3.7978588598382683`*^9, 3.797858864317026*^9}, {
   3.797904824874174*^9, 3.797904894810688*^9}, {3.798125099419313*^9, 
   3.7981250998235064`*^9}, {3.798126562245593*^9, 3.798126567712924*^9}, {
   3.798127979381013*^9, 3.7981279891524076`*^9}, {3.79812802946369*^9, 
   3.79812805458779*^9}, {3.798128380697708*^9, 3.7981283810836287`*^9}, {
   3.798172930867813*^9, 3.798172967961946*^9}, {3.7981730412034893`*^9, 
   3.798173063301434*^9}, {3.7983861148718863`*^9, 3.798386151819887*^9}, {
   3.798387519645976*^9, 3.798387542670513*^9}, 3.798387600139385*^9, {
   3.798387865675828*^9, 3.798387902928583*^9}, {3.798426382263562*^9, 
   3.798426442385022*^9}, {3.798426575143478*^9, 3.798426596333459*^9}, {
   3.7984591426010027`*^9, 3.7984591622095127`*^9}, {3.79846417270835*^9, 
   3.798464172843782*^9}, {3.798881777946307*^9, 3.7988817869690847`*^9}, {
   3.798881817360218*^9, 3.7988818691828833`*^9}, {3.798881914804532*^9, 
   3.798881940623129*^9}, {3.7988819894087954`*^9, 3.798882058411812*^9}, {
   3.798882130776671*^9, 3.798882143225236*^9}, {3.798882201844836*^9, 
   3.798882210170733*^9}, 3.798882267811166*^9, 3.798883531813109*^9, {
   3.798883588877658*^9, 3.798883589523364*^9}, {3.798883709999095*^9, 
   3.79888385516298*^9}, {3.7988839208491488`*^9, 3.7988839249601507`*^9}, {
   3.7988841499649076`*^9, 3.79888419217566*^9}, {3.798884225612853*^9, 
   3.79888425574619*^9}, {3.798884523735381*^9, 3.798884525453816*^9}, {
   3.798884579584021*^9, 3.798884635644473*^9}, {3.79888470254641*^9, 
   3.798884704255159*^9}, {3.7988850728747787`*^9, 3.798885152733987*^9}, {
   3.798885203114883*^9, 3.798885216877926*^9}, {3.7988852596690702`*^9, 
   3.798885260145632*^9}, {3.7988855144925957`*^9, 3.79888554042873*^9}, {
   3.7988856129556007`*^9, 3.7988856165218287`*^9}, {3.798885658430149*^9, 
   3.7988856605741787`*^9}, 3.798886034906261*^9, {3.798886077239307*^9, 
   3.7988860811325693`*^9}, {3.798887157747838*^9, 3.798887163527585*^9}, {
   3.798887342290791*^9, 3.798887346816526*^9}, {3.798887377166644*^9, 
   3.7988874229412327`*^9}, {3.798887518895522*^9, 3.7988875242694693`*^9}, {
   3.798887665409754*^9, 3.798887676892641*^9}, 3.79888828258854*^9, {
   3.79888836383946*^9, 3.798888500853931*^9}, {3.79888910156511*^9, 
   3.7988892461135798`*^9}, {3.7988892834407253`*^9, 3.798889283571251*^9}, {
   3.798889384444772*^9, 3.79888939370722*^9}, {3.798889507265306*^9, 
   3.798889575542001*^9}, {3.798889614957644*^9, 3.798889629709038*^9}, {
   3.798889715041082*^9, 3.798889742578031*^9}, {3.798890623324724*^9, 
   3.798890663073729*^9}, {3.79889074692813*^9, 3.798890769683618*^9}, {
   3.7988908120095577`*^9, 3.798890813110456*^9}, {3.798890914724804*^9, 
   3.798890926283966*^9}, {3.798890968124187*^9, 3.798891001266554*^9}, 
   3.798891063423789*^9, {3.7988912054027843`*^9, 3.798891208284721*^9}, 
   3.798891280220993*^9, {3.798903334816475*^9, 3.7989033461090603`*^9}, {
   3.7989033929671793`*^9, 3.798903427455903*^9}, {3.7989036158029337`*^9, 
   3.798903626547945*^9}, {3.79890377436698*^9, 3.7989037754270906`*^9}, {
   3.798903900978105*^9, 3.7989039018316803`*^9}, {3.798903967592155*^9, 
   3.7989039946626167`*^9}, {3.79890403343517*^9, 3.798904034215304*^9}, {
   3.798904462736261*^9, 3.798904463858007*^9}, {3.798904628335535*^9, 
   3.798904695282694*^9}, {3.798904730003113*^9, 3.798904736388008*^9}, {
   3.798904771119123*^9, 3.798904802454859*^9}, {3.7989048342248507`*^9, 
   3.798904854285994*^9}, {3.798905025292494*^9, 3.798905064037592*^9}, {
   3.798905220713736*^9, 3.79890522160716*^9}, {3.798905273588873*^9, 
   3.798905294332353*^9}, {3.798905349602004*^9, 3.798905363977002*^9}, {
   3.798905419596233*^9, 3.798905447707761*^9}, 3.798905485630576*^9, 
   3.798906199744135*^9, {3.79890635170252*^9, 3.7989063591097507`*^9}, {
   3.7989064164407797`*^9, 3.798906417620887*^9}, {3.798906470023588*^9, 
   3.79890648402682*^9}, {3.798906580455964*^9, 3.798906643662015*^9}, 
   3.798906682758191*^9, {3.7989067377336063`*^9, 3.798906761056138*^9}, {
   3.7989073081432323`*^9, 3.7989073308330317`*^9}, {3.798907402261819*^9, 
   3.798907403164467*^9}, {3.798907453212356*^9, 3.7989074924263268`*^9}, 
   3.7989078768973618`*^9, {3.798908080018383*^9, 3.798908099010703*^9}, {
   3.798908195515088*^9, 3.798908222730187*^9}, {3.798908282994824*^9, 
   3.798908283381803*^9}, {3.798908351033757*^9, 3.7989083536571074`*^9}, {
   3.7989087065696383`*^9, 3.7989087709393797`*^9}, {3.798908859228697*^9, 
   3.7989088603190327`*^9}, {3.7989089175905933`*^9, 3.798908939389345*^9}, {
   3.798910038459572*^9, 3.798910063405006*^9}, 3.798910094352614*^9, {
   3.798910131626371*^9, 3.798910140030325*^9}, {3.798910353641919*^9, 
   3.798910375171184*^9}, {3.798910653570972*^9, 3.7989106732269897`*^9}, {
   3.798954889089963*^9, 3.79895489713437*^9}, {3.79895852738872*^9, 
   3.798958573057029*^9}, {3.798958626330195*^9, 3.798958844926997*^9}, {
   3.798958905683097*^9, 3.7989589634901648`*^9}, {3.798959000965147*^9, 
   3.798959017732497*^9}, {3.798961347102829*^9, 3.7989613637592907`*^9}, {
   3.798961640502956*^9, 3.798961711866678*^9}, {3.798961744321863*^9, 
   3.79896177040549*^9}, {3.7989618171764393`*^9, 3.7989618183057013`*^9}, {
   3.7989618615068617`*^9, 3.798961868084928*^9}, {3.798961940302491*^9, 
   3.798961940578663*^9}, {3.798962053601665*^9, 3.798962058446826*^9}, {
   3.798962137099381*^9, 3.79896213747847*^9}, {3.79896218672821*^9, 
   3.7989622094479227`*^9}, {3.798962525165976*^9, 3.798962529625724*^9}, {
   3.798962981610105*^9, 3.798962982844912*^9}, {3.798963317268931*^9, 
   3.798963352691804*^9}, {3.798967636768631*^9, 3.798967637024118*^9}, {
   3.79897201196874*^9, 3.798972030491672*^9}, {3.798972969577943*^9, 
   3.79897298175469*^9}, 3.799051695590562*^9, {3.799051794822756*^9, 
   3.799051808606283*^9}, {3.799053337714346*^9, 3.799053342722939*^9}, {
   3.799053691668977*^9, 3.799053693718438*^9}, {3.799053790267914*^9, 
   3.799053795002493*^9}, {3.79905389701724*^9, 3.799053922997916*^9}, {
   3.799054389291771*^9, 3.799054399011273*^9}, {3.7991569142283373`*^9, 
   3.799156915112076*^9}, {3.799158773704486*^9, 3.79915877421561*^9}, {
   3.79916720008493*^9, 3.79916720059935*^9}, {3.799167239596759*^9, 
   3.79916724025716*^9}, {3.7991966362122183`*^9, 3.799196682676683*^9}, {
   3.799197367697216*^9, 3.799197368296472*^9}, {3.799197565250223*^9, 
   3.7991975657758293`*^9}, {3.799198627258486*^9, 3.799198627990713*^9}, {
   3.799200859860461*^9, 3.799200876923614*^9}, {3.799200934335175*^9, 
   3.79920093456526*^9}, {3.799201183349061*^9, 3.799201189937879*^9}, {
   3.7992012279637547`*^9, 3.799201228437304*^9}, {3.799202852192191*^9, 
   3.799202852793459*^9}, {3.79920303585927*^9, 3.7992030363043413`*^9}, {
   3.799203753837285*^9, 3.799203754366291*^9}, {3.79920382089676*^9, 
   3.799203821156142*^9}, {3.799204141374099*^9, 3.7992041431821136`*^9}, {
   3.7992059307034607`*^9, 3.799205931038249*^9}, {3.799205962405349*^9, 
   3.799205963135281*^9}, {3.7992201925497417`*^9, 3.799220193150079*^9}, {
   3.799222337755457*^9, 3.799222362830771*^9}, {3.7992239813903723`*^9, 
   3.799223982113987*^9}, {3.799224107573092*^9, 3.799224108275711*^9}, {
   3.799236895190654*^9, 3.7992369251891327`*^9}, {3.799416257469417*^9, 
   3.7994162604289217`*^9}, {3.799459434157627*^9, 3.79945943452195*^9}, {
   3.799459484496716*^9, 3.79945948517712*^9}, {3.804938446936256*^9, 
   3.804938469003854*^9}, {3.804939451964321*^9, 3.8049394853757*^9}, {
   3.8049395948924427`*^9, 3.8049396217754307`*^9}, {3.804939712880787*^9, 
   3.804939718657748*^9}, {3.804939899746687*^9, 3.8049398998839607`*^9}, {
   3.804940008551675*^9, 3.804940009691846*^9}, {3.804941601151248*^9, 
   3.804941601932714*^9}, {3.8049416733098392`*^9, 3.8049418052188263`*^9}, {
   3.804942042468202*^9, 3.804942054475335*^9}, {3.804942124744485*^9, 
   3.804942126671619*^9}, {3.8049423704127274`*^9, 3.804942376819354*^9}, {
   3.8050099729973907`*^9, 3.8050099743902407`*^9}, {3.805010037686701*^9, 
   3.8050100922845907`*^9}, {3.8050119928582077`*^9, 3.805012025968811*^9}, {
   3.805012094607028*^9, 3.805012108965626*^9}, {3.8050147763413067`*^9, 
   3.805014805000177*^9}, {3.80501515503697*^9, 3.80501518354056*^9}, {
   3.805015531179782*^9, 3.805015534556163*^9}, {3.805015803457649*^9, 
   3.805015803586273*^9}, {3.805028502164781*^9, 3.805028512240995*^9}, {
   3.805028687440833*^9, 3.8050286896974154`*^9}, {3.805028727707245*^9, 
   3.805028783403923*^9}, {3.805028814085493*^9, 3.805028837146812*^9}, {
   3.8050905068875113`*^9, 3.805090524721162*^9}, {3.805095059586955*^9, 
   3.805095083226186*^9}, {3.805106447776355*^9, 3.805106455204935*^9}, {
   3.805107475826107*^9, 3.805107489148088*^9}, {3.8144236378130836`*^9, 
   3.8144236395866327`*^9}, {3.814423673758238*^9, 3.814423677574251*^9}, 
   3.815929995602109*^9, {3.816573213650364*^9, 3.816573214819127*^9}, {
   3.81764637761355*^9, 3.8176463850444736`*^9}, {3.817646417661611*^9, 
   3.8176464202059813`*^9}, {3.817647656966372*^9, 3.8176476802386227`*^9}, {
   3.81765900893209*^9, 3.81765901831584*^9}, {3.821677722613556*^9, 
   3.821677733737317*^9}, {3.821677795179793*^9, 3.8216778127807007`*^9}, {
   3.821677843390273*^9, 3.821677893439911*^9}, {3.821678874586046*^9, 
   3.821678887287841*^9}, {3.821679972611085*^9, 3.8216800496876*^9}, {
   3.8216802609425163`*^9, 3.8216802609775343`*^9}, {3.8216809928498983`*^9, 
   3.8216810058322973`*^9}, {3.821681461095166*^9, 3.8216814826314707`*^9}, {
   3.8216831699219437`*^9, 3.821683187641304*^9}, {3.821683237002565*^9, 
   3.821683248852847*^9}, {3.821683299179206*^9, 3.821683308396003*^9}, {
   3.821683492818932*^9, 3.821683530447254*^9}, {3.82168357519458*^9, 
   3.8216835978925133`*^9}, {3.821683655609014*^9, 3.821683671743936*^9}, {
   3.821684820967321*^9, 3.82168487958315*^9}, {3.821684946914619*^9, 
   3.8216849482432528`*^9}, {3.821685142595278*^9, 3.821685154610683*^9}, 
   3.852866999471764*^9, {3.852867156414494*^9, 3.852867300017377*^9}, {
   3.8528673478493757`*^9, 3.852867365993243*^9}, {3.852867567573811*^9, 
   3.852867605263056*^9}, {3.8528676683143*^9, 3.852867875893346*^9}, {
   3.85286844674115*^9, 3.8528684569897614`*^9}, 3.8528691082684917`*^9, 
   3.852870720734783*^9, {3.852870893849226*^9, 3.852870894165626*^9}, {
   3.852871546057494*^9, 3.85287162117171*^9}, {3.852872316384575*^9, 
   3.852872317128697*^9}, {3.852872457470755*^9, 3.852872466204006*^9}, {
   3.852873200127672*^9, 3.852873278645915*^9}, {3.8528733473532877`*^9, 
   3.852873359354492*^9}, {3.855229342873294*^9, 3.855229355557967*^9}, {
   3.8998918468645573`*^9, 3.8998918478849916`*^9}, {3.8998919107422037`*^9, 
   3.899891927600957*^9}, {3.8998919806229267`*^9, 
   3.899891989878376*^9}},ExpressionUUID->"463d29e6-f861-4df9-a604-\
f4b8f68d9194"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"evolutionary", " ", 
    RowBox[{"tree", ":", " ", "visualisation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"xtree", ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.1", "]"}], ",", 
       RowBox[{"PointSize", "[", "0.007", "]"}]}], "}"}]}], " ", ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "50000"}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", ",", "\"\<Evolutionary time\>\""}], "}"}]}], ",", 
    " ", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", " ", "None"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1.5"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.852866988235173*^9, 3.852866989657178*^9}, {
  3.852871485231183*^9, 3.852871493590056*^9}, {3.8528723190232887`*^9, 
  3.852872320484277*^9}, {3.85287332445163*^9, 3.8528733265784817`*^9}, {
  3.899891878660136*^9, 3.899891901795177*^9}, {3.899891994740507*^9, 
  3.8998920001773376`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"a1ba828a-12e3-4655-875d-728390c205a7"]
},
WindowSize->{1280, 684},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bb7aac17-9c49-48f1-b12a-54206d72559a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 487, 11, 50, "Input",ExpressionUUID->"9acefaa5-d0a4-415c-a3e8-fe0bd3ec071e"],
Cell[1048, 33, 167, 3, 31, "Author",ExpressionUUID->"102466a1-488f-41be-9c05-487ee62916d4"],
Cell[1218, 38, 442, 9, 58, "Text",ExpressionUUID->"7fb4750b-40eb-47bc-8bf7-ecaed912b519"],
Cell[1663, 49, 19275, 330, 220, "Input",ExpressionUUID->"398c53f7-1ffb-47de-a950-ea31d118a1a1"],
Cell[20941, 381, 9682, 183, 325, "Input",ExpressionUUID->"5aa158f5-0505-44a2-a337-f3d4d2ef917a"],
Cell[30626, 566, 35009, 737, 1522, "Input",ExpressionUUID->"463d29e6-f861-4df9-a604-f4b8f68d9194"],
Cell[65638, 1305, 1436, 34, 73, "Input",ExpressionUUID->"a1ba828a-12e3-4655-875d-728390c205a7"]
}
]
*)

